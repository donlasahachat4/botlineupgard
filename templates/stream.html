<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏î‡∏π‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏™‡∏î</title>
  <link rel="stylesheet" href="/static/style.css">
  <script src="//cdn.socket.io/4.6.1/socket.io.min.js"></script>
</head>
<body>
  <h2>üî¥ ‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏™‡∏î‡πÅ‡∏°‡∏ï‡∏ä‡πå</h2>
  <video id="hls-video" controls autoplay width="100%" style="max-width:720px;">
    <source src="{{ stream_url }}" type="application/x-mpegURL">
    ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏ö‡∏ö HLS
  </video>
  <p style="text-align:right;">
    <b>‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô:</b> <span id="userBalance">{{ wallet.balance }}</span> ‡∏ö‡∏≤‡∏ó
  </p>
  <div>
    <button onclick="bet('‡πÅ‡∏î‡∏á', 100)">‡πÅ‡∏ó‡∏á‡πÅ‡∏î‡∏á 100</button>
    <button onclick="bet('‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô', 100)">‡πÅ‡∏ó‡∏á‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô 100</button>
  </div>
  <div id="betResult"></div>
  <div class="chat-container">
    <h3>‡πÅ‡∏ä‡∏ó‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏ï‡∏£‡∏µ‡∏°</h3>
    <div id="chat-box" style="border:1px solid #ccc; height:200px; overflow:auto; margin-bottom:5px;"></div>
    <input type="text" id="chat-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏ä‡∏ó..." style="width:70%">
    <button onclick="sendChat()">‡∏™‡πà‡∏á</button>
  </div>

  <script>
    const socket = io();
    function bet(side, amount){
      socket.emit('bet', {side: side, amount: amount});
    }
    socket.on('bet_placed', function(data){
      document.getElementById('betResult').innerText = '‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
      document.getElementById('userBalance').innerText = data.balance.toFixed(2);
    });
    socket.on('bet_error', function(data){
      alert(data.msg);
    });
    socket.on('balance_update', function(data){
      document.getElementById('userBalance').innerText = data.balance.toFixed(2);
    });

    function sendChat(){
      const msg = document.getElementById('chat-input').value.trim();
      if(msg){
        socket.emit('chat', {msg: msg});
        document.getElementById('chat-input').value = '';
      }
    }
    socket.on('chat_broadcast', function(data){
      const chatbox = document.getElementById('chat-box');
      chatbox.innerHTML += `<b>${data.user}</b>: ${data.msg}<br>`;
      chatbox.scrollTop = chatbox.scrollHeight;
    });
  </script>
</body>
</html>
